<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 300">
  <defs>
    <linearGradient id="bgGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0a1628"/>
      <stop offset="100%" style="stop-color:#1a0a2a"/>
    </linearGradient>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto">
      <path d="M0,0 L10,5 L0,10 Z" fill="#888"/>
    </marker>
  </defs>

  <!-- 背景 -->
  <rect width="800" height="300" fill="url(#bgGrad)"/>

  <!-- 标题 -->
  <text x="400" y="30" fill="#ffffff" font-size="18" font-family="Arial" font-weight="bold" text-anchor="middle">Feed-Forward Network：两层全连接</text>

  <!-- 输入 -->
  <rect x="40" y="100" width="70" height="90" rx="5" fill="#3b82f6" fill-opacity="0.3" stroke="#3b82f6" stroke-width="2"/>
  <text x="75" y="140" fill="#3b82f6" font-size="11" font-family="Arial" text-anchor="middle">输入</text>
  <text x="75" y="158" fill="#3b82f6" font-size="12" font-family="Arial" text-anchor="middle" font-weight="bold">512</text>

  <!-- 第一层：W₁ -->
  <line x1="110" y1="145" x2="155" y2="145" stroke="#888" stroke-width="2" marker-end="url(#arrow)"/>

  <rect x="160" y="85" width="90" height="120" rx="5" fill="#f59e0b" fill-opacity="0.2" stroke="#f59e0b" stroke-width="2"/>
  <text x="205" y="125" fill="#f59e0b" font-size="10" font-family="Arial" text-anchor="middle">W₁</text>
  <text x="205" y="145" fill="#f59e0b" font-size="11" font-family="Arial" text-anchor="middle" font-weight="bold">512×2048</text>
  <text x="205" y="165" fill="#666" font-size="9" font-family="Arial" text-anchor="middle">（放大）</text>

  <!-- 隐藏层 -->
  <line x1="250" y1="145" x2="295" y2="145" stroke="#888" stroke-width="2" marker-end="url(#arrow)"/>

  <rect x="300" y="60" width="80" height="170" rx="5" fill="#22c55e" fill-opacity="0.3" stroke="#22c55e" stroke-width="2"/>
  <text x="340" y="130" fill="#22c55e" font-size="11" font-family="Arial" text-anchor="middle">隐藏层</text>
  <text x="340" y="150" fill="#22c55e" font-size="14" font-family="Arial" text-anchor="middle" font-weight="bold">2048</text>
  <text x="340" y="170" fill="#666" font-size="9" font-family="Arial" text-anchor="middle">（4 倍）</text>

  <!-- ReLU -->
  <line x1="380" y1="145" x2="425" y2="145" stroke="#888" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="402" y="135" fill="#ef4444" font-size="9" font-family="Arial" text-anchor="middle">ReLU</text>

  <!-- 第二层：W₂ -->
  <rect x="430" y="85" width="90" height="120" rx="5" fill="#f59e0b" fill-opacity="0.2" stroke="#f59e0b" stroke-width="2"/>
  <text x="475" y="125" fill="#f59e0b" font-size="10" font-family="Arial" text-anchor="middle">W₂</text>
  <text x="475" y="145" fill="#f59e0b" font-size="11" font-family="Arial" text-anchor="middle" font-weight="bold">2048×512</text>
  <text x="475" y="165" fill="#666" font-size="9" font-family="Arial" text-anchor="middle">（缩小）</text>

  <!-- 输出 -->
  <line x1="520" y1="145" x2="565" y2="145" stroke="#888" stroke-width="2" marker-end="url(#arrow)"/>

  <rect x="570" y="100" width="70" height="90" rx="5" fill="#8b5cf6" fill-opacity="0.3" stroke="#8b5cf6" stroke-width="2"/>
  <text x="605" y="140" fill="#8b5cf6" font-size="11" font-family="Arial" text-anchor="middle">输出</text>
  <text x="605" y="158" fill="#8b5cf6" font-size="12" font-family="Arial" text-anchor="middle" font-weight="bold">512</text>

  <!-- 残差连接 -->
  <path d="M75,190 L75,245 L605,245 L605,190" stroke="#06b6d4" stroke-width="2" fill="none" stroke-dasharray="5,3"/>
  <circle cx="680" cy="145" r="15" fill="none" stroke="#06b6d4" stroke-width="2"/>
  <text x="680" y="150" fill="#06b6d4" font-size="14" font-family="Arial" text-anchor="middle">+</text>
  <line x1="640" y1="145" x2="665" y2="145" stroke="#8b5cf6" stroke-width="2"/>
  <line x1="680" y1="160" x2="680" y2="245" stroke="#06b6d4" stroke-width="2"/>
  <text x="340" y="263" fill="#06b6d4" font-size="10" font-family="Arial" text-anchor="middle">残差连接（跳过整个 FFN）</text>

  <!-- 最终输出 -->
  <line x1="695" y1="145" x2="740" y2="145" stroke="#888" stroke-width="2" marker-end="url(#arrow)"/>
  <rect x="745" y="120" width="45" height="50" rx="5" fill="#ffffff" fill-opacity="0.1" stroke="#888" stroke-width="1"/>
  <text x="768" y="150" fill="#aaa" font-size="9" font-family="Arial" text-anchor="middle">输出</text>

  <!-- 底部公式 -->
  <text x="400" y="290" fill="#aaa" font-size="11" font-family="Arial" text-anchor="middle">FFN(x) = W₂ · ReLU(W₁ · x + b₁) + b₂</text>
</svg>
